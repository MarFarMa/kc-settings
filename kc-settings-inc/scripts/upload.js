var win=window.dialogArguments||opener||parent||top;function in_array(c,b){for(var a in b){if(c===b[a]){return true}}return false}jQuery(document).ready(function(d){var f=d("#library-form, #gallery-form"),e=d("#file-form");$mItems=d("#media-items");if(f.length){var c=win.kcSettings.upload.text,a=d('<div class="kcs-wrap"><h4>'+c.head+"</h4></div>");if(!$mItems.children().length){a.append("<p>"+c.empty+"</p>")}else{var b=d('<a class="button">'+c.checkAll+"</a>");$btClear=d('<a class="button">'+c.clear+"</a>");$btInvert=d('<a class="button">'+c.invert+"</a>");$btAdd=d('<a class="button">'+c.addFiles+"</a>");d(".new",$mItems).each(function(j){var i=d(this).parent(),h=i.attr("id").split("-")[2],g=(in_array(h,win.kcSettings.upload.files))?' checked="checked"':"";$input=d('<input type="checkbox" value="'+h+'" '+g+'class="kcs-files" style="margin-right:.5em"/>');i.children(".new").prepend($input).wrapInner("<label />")});b.click(function(g){g.preventDefault();d("input.kcs-files",$mItems).each(function(){d(this).prop("checked",true)})});$btClear.click(function(g){g.preventDefault();d("input.kcs-files",$mItems).each(function(){d(this).prop("checked",false)})});$btInvert.click(function(g){g.preventDefault();d("input.kcs-files",$mItems).each(function(){if(this.checked){d(this).prop("checked",false)}else{d(this).prop("checked",true)}})});$btAdd.click(function(h){h.preventDefault();var g=0;win.kcSettings.upload.nu=[];d("input.kcs-files",$mItems).each(function(){var i=d(this);if(!in_array(this.value,win.kcSettings.upload.files)&&this.checked){win.kcSettings.upload.nu.push([this.value,i.siblings(".title").text(),i.closest(".media-item").find(".pinkynail").attr("src")])}});win.kcSettings.upload.nuCount=g;win.kcsInsertFiles();win.tb_remove()});a.append(b,$btClear,$btInvert,$btAdd)}f.append(a)}else{if(e.length){e.after('<div class="kcs-file-info"><h3>'+win.kcSettings.upload.text.head+"</h3><p>"+win.kcSettings.upload.text.info+"</p><div>")}}});